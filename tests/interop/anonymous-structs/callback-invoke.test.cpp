/**
 * Generated by C-Next Transpiler from: callback-invoke.test.cnx
 * A safer C for embedded systems
 */

// test-cpp-only
// test-execution
// Test: Callback invocation with struct containing anonymous member
// Note: This test validates struct init with anon members AND callback invocation.
// The callback handler uses const SimpleConfig& in C++ mode, which is compatible
// with the callback typedef because the struct is passed through the field.
#include "anon_types.h"

#include <stdint.h>

// Global to track callback was called with correct value
int32_t g_callback_value = 0;

void my_config_handler(const SimpleConfig& cfg) {
    g_callback_value = cfg.value + cfg.flags.flag_a;
}

int main(void) {
    SimpleConfig cfg = (SimpleConfig){ .value = 100, .flags = { .flag_a = 1 } };
    my_config_handler(cfg);
    if (g_callback_value != 101) return 1;
    return 0;
}
