/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

// test-execution
// Test: Assigning C-Next function to C callback typedef
// Verifies signature compatibility in both C and C++ modes
#include "callback_types.h"

#include <stdint.h>

int32_t handler_sum = 0;

// C-Next function that should be assignable to PointCallback
void my_point_handler(Point p) {
    handler_sum = p.x + p.y;
}

int main(void) {
    PointCallback cb = my_point_handler;
    Point p1 = (Point){ .x = 3, .y = 7 };
    cb(p1);
    if (handler_sum != 10) return 1;
    handler_sum = 0;
    PointHandler handler = (PointHandler){ .on_point = my_point_handler };
    Point p2 = (Point){ .x = 5, .y = 15 };
    handler.on_point(p2);
    if (handler_sum != 20) return 2;
    handler_sum = 0;
    register_callback(my_point_handler);
    if (handler_sum != 30) return 3;
    return 0;
}
