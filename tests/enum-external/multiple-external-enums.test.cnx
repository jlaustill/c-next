// test-transpile-only
// Issue #465: Test multiple external enums from different files
// Verifies that enum prefixing works when including multiple files with enums

#include "types.cnx"
#include "status.cnx"

struct DeviceState {
    EPressureType pressure;
    EStatus status;
}

void configure(DeviceState state) {
    state.pressure <- PRESSURE_TYPE_PSIG;
    state.status <- STATUS_ACTIVE;
}

u32 main() {
    DeviceState dev <- {
        pressure: PRESSURE_TYPE_PSIA,
        status: STATUS_IDLE
    };

    // Test 1: Initial values from different external enums
    if (dev.pressure != EPressureType.PRESSURE_TYPE_PSIA) return 1;
    if (dev.status != EStatus.STATUS_IDLE) return 2;

    // Test 2: Assignment via function
    configure(dev);
    if (dev.pressure != EPressureType.PRESSURE_TYPE_PSIG) return 3;
    if (dev.status != EStatus.STATUS_ACTIVE) return 4;

    // Test 3: Direct assignment mixing both enums
    dev.pressure <- PRESSURE_TYPE_PSIA;
    dev.status <- STATUS_ERROR;
    if (dev.pressure != EPressureType.PRESSURE_TYPE_PSIA) return 5;
    if (dev.status != EStatus.STATUS_ERROR) return 6;

    return 0;
}
