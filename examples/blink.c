/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

/* Register: GPIOB @ 0x40020400 */
typedef struct {
    volatile uint32_t MODER;
    volatile uint32_t ODR;
} GPIOB_TypeDef;

#define GPIOB (*(volatile GPIOB_TypeDef*)0x40020400)

/* Namespace: Timing */
static uint32_t Timing_tickCount;

void Timing_init(void) {
    Timing_tickCount = 0;
}

void Timing_delay(uint32_t* ms) {
    uint32_t start = Timing_tickCount;
    while (Timing_tickCount - start < ms) {
    }
}

void Timing_tick(void) {
    Timing_tickCount = Timing_tickCount + 1;
}

/* Namespace: LED */
static uint32_t LED_pin;

void LED_init(uint32_t* ledPin) {
    LED_pin = ledPin;
    GPIOB.MODER = GPIOB.MODER | (1 << (LED_pin * 2));
}

void LED_on(void) {
    GPIOB.ODR = GPIOB.ODR | (1 << LED_pin);
}

void LED_off(void) {
    GPIOB.ODR = GPIOB.ODR & ~(1 << LED_pin);
}

void LED_toggle(void) {
    GPIOB.ODR = GPIOB.ODR ^ (1 << LED_pin);
}

void setup(void) {
    Timing_init();
    LED_init(13);
}

void loop(void) {
    LED_toggle();
    Timing_delay(500);
}
