/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include "issue-322-auto-address-of.test.hpp"

// test-execution
// Issue #322: Auto address-of for external C++ functions expecting pointers
// The transpiler should automatically add & when passing structs to external
// functions that expect pointer parameters (AppConfig*)
#include "issue-322-auto-address-of.hpp"

#include <stdint.h>

/* Scope: ConfigManager */
static AppConfig ConfigManager_config = {};

void ConfigManager_initConfig(void) {
    ConfigManager_config.timeout = 1000U;
    ConfigManager_config.retries = 3U;
}

void ConfigManager_loadFromStorage(void) {
    ConfigStorage::loadConfig(&ConfigManager_config);
}

uint32_t ConfigManager_getTimeout(void) {
    return ConfigStorage::getTimeout(&ConfigManager_config);
}

int main(void) {
    ConfigManager_initConfig();
    uint32_t timeout = ConfigManager_getTimeout();
    if (timeout != 1000) return 1;
    ConfigManager_loadFromStorage();
    timeout = ConfigManager_getTimeout();
    if (timeout != 2000) return 2;
    return 0;
}
