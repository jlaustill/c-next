/* test-execution */ // Test .length property on struct members from C headers
// This is the core test for issue #45 - verifies SymbolTable integration
// TestConfig.h defines: typedef struct { uint32_t magic; uint16_t version; uint8_t flags; uint64_t timestamp; } AppConfig;
#include "../../include/TestConfig.h"

// Also define in C-Next for semantic analysis (actual type comes from C header)
// The code generation should use SymbolTable (C header types), not this definition
struct CNextConfig {
    u32 magic;
    u16 version;
    u8 flags;
    u64 timestamp;
}

i32 main() {
    // Test C-Next struct (baseline - should already work)
    CNextConfig localCfg;
    localCfg.magic <- 0x11111111;
    localCfg.version <- 10;
    localCfg.flags <- 0xAA;
    localCfg.timestamp <- 9999999;

    if (localCfg.magic.length != 32) {
        return 1;
    }

    if (localCfg.version.length != 16) {
        return 2;
    }

    if (localCfg.flags.length != 8) {
        return 3;
    }

    if (localCfg.timestamp.length != 64) {
        return 4;
    }

    // Test compile-time constant evaluation
    u8 magicBytes <- localCfg.magic.length / 8;
    if (magicBytes != 4) {
        return 5;
    }

    return 0; // All tests passed
}
