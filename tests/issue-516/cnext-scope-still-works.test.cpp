/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include "cnext-scope-still-works.test.hpp"

#include <stdint.h>

// Tests: C-Next scopes still use _ separator after issue #516 fix
// Ensures we didn't break existing C-Next scope functionality
/* Scope: Motor */
uint8_t Motor_speed = 0;

void Motor_start(void) {
    Motor_speed = 100U;
}

void Motor_stop(void) {
    Motor_speed = 0U;
}

/* Scope: Controller */

void Controller_run(void) {
    Motor_start();
    Motor_stop();
    uint8_t s = Motor_speed;
}

int main(void) {
    if (Motor_speed != 0) return 1;
    Motor_start();
    if (Motor_speed != 100) return 2;
    Motor_stop();
    if (Motor_speed != 0) return 3;
    Motor_start();
    Controller_run();
    if (Motor_speed != 0) return 4;
    return 0;
}
