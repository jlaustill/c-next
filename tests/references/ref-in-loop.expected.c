/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>

// test-coverage: 27-ref-in-loop
// test-execution
// Tests: Modifying reference parameter inside loops
// Increments value N times
void incrementN(uint32_t* value, const uint32_t* times) {
    uint32_t i = 0;
    while (i < (*times)) {
        (*value) = (*value) + 1;
        i = i + 1;
    }
}

// Doubles value N times
void doubleN(uint32_t* value, const uint32_t* times) {
    uint32_t i = 0;
    while (i < (*times)) {
        (*value) = (*value) * 2;
        i = i + 1;
    }
}

// Accumulates sum using a loop
void accumulate(const uint32_t* start, const uint32_t* end, uint32_t* result) {
    (*result) = 0;
    uint32_t i = (*start);
    while (i <= (*end)) {
        (*result) = (*result) + i;
        i = i + 1;
    }
}

// Factorial via loop
void factorial(const uint32_t* n, uint32_t* result) {
    (*result) = 1;
    uint32_t i = 1;
    while (i <= (*n)) {
        (*result) = (*result) * i;
        i = i + 1;
    }
}

// Modifies multiple refs in same loop
void parallelIncrement(uint32_t* a, uint32_t* b, const uint32_t* times) {
    uint32_t i = 0;
    while (i < (*times)) {
        (*a) = (*a) + 1;
        (*b) = (*b) + 2;
        i = i + 1;
    }
}

int main(void) {
    uint32_t val = 10;
    incrementN(&val, &(uint32_t){5});
    if (val != 15) return 1;
    val = 0;
    incrementN(&val, &(uint32_t){100});
    if (val != 100) return 2;
    val = 1;
    doubleN(&val, &(uint32_t){4});
    if (val != 16) return 3;
    val = 3;
    doubleN(&val, &(uint32_t){3});
    if (val != 24) return 4;
    uint32_t sum = 999;
    accumulate(&(uint32_t){1}, &(uint32_t){5}, &sum);
    if (sum != 15) return 5;
    accumulate(&(uint32_t){1}, &(uint32_t){10}, &sum);
    if (sum != 55) return 6;
    accumulate(&(uint32_t){5}, &(uint32_t){5}, &sum);
    if (sum != 5) return 7;
    uint32_t fact = 0;
    factorial(&(uint32_t){5}, &fact);
    if (fact != 120) return 8;
    factorial(&(uint32_t){1}, &fact);
    if (fact != 1) return 9;
    factorial(&(uint32_t){6}, &fact);
    if (fact != 720) return 10;
    uint32_t x = 0;
    uint32_t y = 0;
    parallelIncrement(&x, &y, &(uint32_t){5});
    if (x != 5) return 11;
    if (y != 10) return 12;
    x = 10;
    y = 20;
    parallelIncrement(&x, &y, &(uint32_t){3});
    if (x != 13) return 13;
    if (y != 26) return 14;
    return 0;
}
