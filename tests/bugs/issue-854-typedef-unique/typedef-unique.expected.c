/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include "typedef-unique.test.h"

// Issue #854: MISRA Rule 5.6 - typedef name shall be unique
// test-execution
// When including a cnx file that defines a struct, the generated header
// should NOT emit a forward declaration typedef for that struct,
// because it's already available via the #include.
#include <typedef-types.h>

#include <stdint.h>

/* Scope: Reader */
static Sensor Reader_current = {0};

void Reader_update(const Sensor* s) {
    Reader_current = (*s);
}

Sensor Reader_read(void) {
    return Reader_current;
}

int main(void) {
    Sensor s = (Sensor){ .id = 42U, .value = 100U };
    Reader_update(&s);
    Sensor result = Reader_read();
    if (result.id != 42) return 1;
    if (result.value != 100) return 2;
    return 0;
}
