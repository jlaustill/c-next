// tests/functions/enum-bool-member-cpp.test.cnx
/* test-execution */
// Tests: Issue #252 - enum and bool types not converted to u8
// In C++ mode, bool* and enum* cannot convert to uint8_t*
// Must use static_cast<uint8_t>() with temp variable

#include "enum-bool-member-cpp.h"

u32 process(u32 crc, u8 byte) {
    return crc ^ byte;
}

u32 testEnumBoolMembers(SensorConfig cfg) {
    u32 crc <- 0;
    // Each of these should generate temp with static_cast:
    // uint8_t _cnx_tmp_0 = static_cast<uint8_t>(cfg->enabled);
    crc <- process(crc, cfg.enabled);         // bool -> u8
    crc <- process(crc, cfg.pressureType);    // EPressureType -> u8
    crc <- process(crc, cfg.thermocoupleType); // EThermocoupleType -> u8
    crc <- process(crc, cfg.value);           // u8 -> u8 (no conversion needed)
    return crc;
}

u32 main() {
    SensorConfig cfg;
    cfg.enabled <- true;
    cfg.pressureType <- PRESSURE_HIGH;
    cfg.thermocoupleType <- TC_TYPE_J;
    cfg.value <- 4;

    // Expected: 0 ^ 1 ^ 2 ^ 1 ^ 4 = 6
    u32 result <- testEnumBoolMembers(cfg);
    if (result != 6) return 1;

    return 0;
}
