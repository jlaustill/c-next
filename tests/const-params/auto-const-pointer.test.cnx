// test-execution
// Tests: Issue #268 - automatic const for unmodified pointer parameters

// Read-only parameter - should get const
void readOnly(u32 value) {
    u32 local <- value;  // Only reads, never assigns
}

// Modified parameter - should NOT get const
void modified(u32 value) {
    value <- 42;  // Direct assignment
}

// Multiple params - mixed const/non-const
u32 mixedParams(u32 readVal, u32 writeVal) {
    writeVal <- readVal + 10;  // readVal read-only, writeVal modified
    return writeVal;
}

// Array parameter modification via index
void arrayMod(u8 arr[4]) {
    arr[0] <- 99;  // Array element modified - no const on arr
}

// Array parameter read-only
u8 arrayReadOnly(u8 arr[4]) {
    return arr[0];  // Only reads - should get const
}

u32 main() {
    u32 x <- 10;
    readOnly(x);
    if (x != 10) return 1;  // x unchanged

    modified(x);
    // Note: x is passed by pointer but modified inside function
    // The function modifies its local copy (the parameter)

    u32 a <- 5;
    u32 b <- 0;
    u32 result <- mixedParams(a, b);
    if (result != 15) return 2;

    u8[4] data <- [1, 2, 3, 4];
    arrayMod(data);
    if (data[0] != 99) return 3;

    u8[4] data2 <- [10, 20, 30, 40];
    u8 val <- arrayReadOnly(data2);
    if (val != 10) return 4;

    return 0;
}
