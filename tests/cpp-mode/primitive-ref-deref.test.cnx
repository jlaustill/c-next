// test-cpp-only
// Bug #558: Primitive parameter reassigned should not use pointer dereference in C++ mode
// When a primitive is reassigned, it becomes a reference (uint32_t&)
// The body should use 'val' directly, not '(*val)'

scope Test {
    u32 helper(u32 x) {
        return x + 1;
    }

    public u32 process(u32 val) {
        val <- this.helper(val);
        return val;
    }
}

u32 main() {
    u32 input <- 5;
    u32 result <- global.Test.process(input);
    // process calls helper(5) which returns 6, then assigns to val
    if (result != 6) return 1;
    return 0;
}
