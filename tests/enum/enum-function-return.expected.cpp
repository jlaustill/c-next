/**
 * Generated by C-Next Transpiler from: enum-function-return.test.cnx
 * A safer C for embedded systems
 */

#include <stdint.h>

// test-coverage: 10-enum-function-return
// test-execution
// Tests: Enum as function return type
typedef enum {
    Color_RED = 0,
    Color_GREEN = 1,
    Color_BLUE = 2,
    Color_YELLOW = 3
} Color;

typedef enum {
    TrafficLight_STOP = 0,
    TrafficLight_CAUTION = 1,
    TrafficLight_GO = 2
} TrafficLight;

// Function that returns enum based on input
Color getColorByIndex(uint32_t index) {
    if (index == 0) {
        return Color_RED;
    }
    if (index == 1) {
        return Color_GREEN;
    }
    if (index == 2) {
        return Color_BLUE;
    }
    return Color_YELLOW;
}

// Function that returns enum based on condition
TrafficLight getNextLight(TrafficLight current) {
    if (current == TrafficLight_STOP) {
        return TrafficLight_GO;
    }
    if (current == TrafficLight_GO) {
        return TrafficLight_CAUTION;
    }
    return TrafficLight_STOP;
}

// Function that maps one enum to another
TrafficLight colorToLight(Color c) {
    if (c == Color_RED) {
        return TrafficLight_STOP;
    }
    if (c == Color_GREEN) {
        return TrafficLight_GO;
    }
    return TrafficLight_CAUTION;
}

int main(void) {
    Color c = getColorByIndex(0U);
    if (c != Color_RED) return 1;
    c = getColorByIndex(1U);
    if (c != Color_GREEN) return 2;
    c = getColorByIndex(2U);
    if (c != Color_BLUE) return 3;
    c = getColorByIndex(99U);
    if (c != Color_YELLOW) return 4;
    TrafficLight light = TrafficLight_STOP;
    light = getNextLight(light);
    if (light != TrafficLight_GO) return 5;
    light = getNextLight(light);
    if (light != TrafficLight_CAUTION) return 6;
    light = getNextLight(light);
    if (light != TrafficLight_STOP) return 7;
    TrafficLight mapped = colorToLight(Color_RED);
    if (mapped != TrafficLight_STOP) return 8;
    mapped = colorToLight(Color_GREEN);
    if (mapped != TrafficLight_GO) return 9;
    mapped = colorToLight(Color_BLUE);
    if (mapped != TrafficLight_CAUTION) return 10;
    return 0;
}
