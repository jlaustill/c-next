/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include "chain-forward.test.hpp"

// Issue #404: Chained forward declarations across multiple files
// test-execution
// Tests forward declarations when types form a chain: test -> mid -> base
// This validates transitive include handling.
#include <chain-types-mid.h>

#include <stdint.h>

/* Scope: Navigator */
static Waypoint Navigator_current = {0};
static Waypoint Navigator_destination = {0};

void Navigator_setDestination(const Waypoint& wp) {
    Navigator_destination = wp;
}

Waypoint Navigator_getDestination(void) {
    return Navigator_destination;
}

void Navigator_moveTo(const Coordinate& pos) {
    Navigator_current.position = pos;
}

Coordinate Navigator_getCurrentPosition(void) {
    return Navigator_current.position;
}

int main(void) {
    Coordinate dest = (Coordinate){ .x = 100, .y = 200, .z = 50 };
    Waypoint wp = (Waypoint){ .position = dest, .id = 42U };
    Navigator_setDestination(wp);
    Waypoint retrieved = Navigator_getDestination();
    if (retrieved.id != 42) return 1;
    if (retrieved.position.x != 100) return 2;
    if (retrieved.position.y != 200) return 3;
    if (retrieved.position.z != 50) return 4;
    Coordinate newPos = (Coordinate){ .x = 10, .y = 20, .z = 5 };
    Navigator_moveTo(newPos);
    Coordinate currentPos = Navigator_getCurrentPosition();
    if (currentPos.x != 10) return 5;
    if (currentPos.y != 20) return 6;
    if (currentPos.z != 5) return 7;
    return 0;
}
