/**
 * Generated by C-Next Transpiler from: switch-array-subscript.test.cnx
 * A safer C for embedded systems
 */

#include <stdint.h>

// test-execution
// Tests: switch on array element subscript (bug fix)
// Verifies that switch(array[index]) correctly resolves as element type, not bool
uint32_t result = 0;

void handleByArray(const uint8_t data[4], uint8_t idx) {
    switch (data[idx]) {
        case 1: {
            result = 10U;
            break;
        }
        case 2: {
            result = 20U;
            break;
        }
        case 3: {
            result = 30U;
            break;
        }
        default: {
            result = 99U;
            break;
        }
    }
}

int main(void) {
    uint8_t arr[4] = {1U, 2U, 3U, 4U};
    uint8_t idx0 = 0U;
    uint8_t idx1 = 1U;
    uint8_t idx2 = 2U;
    uint8_t idx3 = 3U;
    handleByArray(arr, idx0);
    if (result != 10) return 1;
    handleByArray(arr, idx1);
    if (result != 20) return 2;
    handleByArray(arr, idx2);
    if (result != 30) return 3;
    handleByArray(arr, idx3);
    if (result != 99) return 4;
    return 0;
}
