// test-execution
// ADR-045: Validate substring extraction at runtime
// Issue #140 fixed: Single-character substring source[i] now generates valid C
i32 main() {
    string<64> source <- "Hello, World!";

   
// Test 1-3: Basic substring from start
    string<5> hello <- source[0, 5];
    if (hello.length != 5) return 1;
    if (hello != "Hello") return 2;
    if (hello.capacity != 5) return 3;

   
// Test 4-5: Substring with offset
    string<6> world <- source[7, 6];
    if (world.length != 6) return 4;
    if (world != "World!") return 5;

   
// Test 6-7: Single character using source[i] syntax (issue #140 fixed)
    string<1> h <- source[0];
    if (h.length != 1) return 6;
    if (h != "H") return 7;

   
// Test 8: Different single char
    string<1> comma <- source[5];
    if (comma != ",") return 8;

   
// Test 9-10: Middle substring
    string<5> middle <- source[3, 5];
    if (middle.length != 5) return 9;
    if (middle != "lo, W") return 10;

   
// Test 11-12: Substring entire string
    string<13> full <- source[0, 13];
    if (full.length != 13) return 11;
    if (full != "Hello, World!") return 12;

   
// Test 13-14: Substring of 2 chars
    string<2> two <- source[0, 2];
    if (two.length != 2) return 13;
    if (two != "He") return 14;

   
// Test 15: Last character using source[i] syntax
    string<1> last <- source[12];
    if (last != "!") return 15;

    return 0;
}
