/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// Postfix Chain Test: Register + Bitmap + Bit Indexing
// Tests: Complex chains mixing hardware registers, bitmap fields, and bit access
// HIGH RISK AREA: Lines 5850-6285 in CodeGenerator.ts
/* Bitmap: StatusFlags */
/* Fields:
 *   Ready: bit 0 (1 bit)
 *   Error: bit 1 (1 bit)
 *   Mode: bits 2-4 (3 bits)
 *   Reserved: bits 5-7 (3 bits)
 */
typedef uint8_t StatusFlags;

/* Bitmap: ControlFlags */
/* Fields:
 *   Enable: bit 0 (1 bit)
 *   Direction: bit 1 (1 bit)
 *   Speed: bits 2-9 (8 bits)
 *   Reserved: bits 10-15 (6 bits)
 */
typedef uint16_t ControlFlags;

/* Register: MOTOR @ 0x40001000 */
#define MOTOR_STATUS (*(volatile StatusFlags*)(0x40001000 + 0x00))
#define MOTOR_CONTROL (*(volatile ControlFlags*)(0x40001000 + 0x04))
#define MOTOR_DATA (*(volatile uint32_t*)(0x40001000 + 0x08))

int main(void) {
    MOTOR_STATUS = (MOTOR_STATUS & ~(1U << 0)) | (1U << 0);
    MOTOR_STATUS = (MOTOR_STATUS & ~(1U << 1)) | (0U << 1);
    MOTOR_STATUS = (MOTOR_STATUS & ~(0x7 << 2)) | ((5 & 0x7) << 2);
    bool isReady = ((MOTOR_STATUS >> 0) & 1);
    bool hasError = ((MOTOR_STATUS >> 1) & 1);
    uint8_t mode = ((MOTOR_STATUS >> 2) & 0x7);
    MOTOR_CONTROL = (MOTOR_CONTROL & ~(1U << 0)) | (1U << 0);
    MOTOR_CONTROL = (MOTOR_CONTROL & ~(1U << 1)) | (0U << 1);
    MOTOR_CONTROL = (MOTOR_CONTROL & ~(0xFF << 2)) | ((127 & 0xFF) << 2);
    uint8_t speed = ((MOTOR_CONTROL >> 2) & 0xFF);
    bool enabled = ((MOTOR_CONTROL >> 0) & 1);
    MOTOR_DATA = (MOTOR_DATA & ~(1U << 0)) | (1U << 0);
    MOTOR_DATA = (MOTOR_DATA & ~(1U << 15)) | (0U << 15);
    MOTOR_DATA = (MOTOR_DATA & ~(1U << 31)) | (1U << 31);
    bool bit0 = ((MOTOR_DATA >> 0) & 1);
    bool bit15 = ((MOTOR_DATA >> 15) & 1);
    if (((MOTOR_STATUS >> 0) & 1) == true) {
        MOTOR_CONTROL = (MOTOR_CONTROL & ~(1U << 0)) | (1U << 0);
    }
    uint8_t doubleSpeed = ((MOTOR_CONTROL >> 2) & 0xFF) * 2U;
}
