// Issue #797: Transpiler incorrectly infers const when function delegates mutation

struct Data {
    u8 value;
}

scope Test {
    // Directly mutates — transpiler correctly generates non-const
    void fillData(Data d) {
        d.value <- 42;
    }

    // Delegates mutation — transpiler should generate non-const
    public void loadData(Data d) {
        fillData(d);  // passes to non-const function, so d must be non-const
    }
}

u32 main() {
    Data d <- {value: 0};

    // Verify initial value
    if (d.value != 0) return 1;

    // Call loadData which delegates to fillData
    global.Test.loadData(d);

    // Verify value was mutated through delegation
    if (d.value != 42) return 2;

    return 0;
}
