/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

// tests/functions/const-struct-member-cpp.test.cnx
/* test-execution */
// Tests: Issue #251 - const struct members passed to non-const parameters
// In C++ mode, passing &const_struct->member to non-const T* is invalid
// Must copy to temp variable first
#include "const-struct-member-cpp.h"

#include <stdint.h>

uint32_t process(uint32_t crc, uint8_t byte) {
    return crc ^ byte;
}

uint32_t testConstStruct(const TestConfig* cfg) {
    uint32_t crc = 0;
    crc = process(crc, (*cfg).value);
    return crc;
}

int main(void) {
    TestConfig cfg = {};
    cfg.value = 0x42;
    cfg.flags = 0xFF;
    uint32_t result = testConstStruct(&cfg);
    if (result != 0x42) return 1;
    return 0;
}
