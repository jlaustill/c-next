/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

// test-cpp-only
// test-execution
// Test: Struct with anonymous member used as function argument
#include "anon_types.h"

#include <stdint.h>

// Test function that takes struct with anonymous member
int32_t check_simple(const SimpleConfig& cfg) {
    if (cfg.value != 99) return 1;
    if (cfg.flags.flag_b != 1) return 2;
    return 0;
}

int32_t check_display(const DisplayConfig& disp) {
    if (disp.resolution.width != 1024) return 1;
    if (disp.resolution.height != 768) return 2;
    if (disp.settings.brightness != 100) return 3;
    return 0;
}

int32_t check_panel(const PanelConfig& panel) {
    if (panel.clk_src != 1) return 1;
    if (panel.timings.h_res != 800) return 2;
    if (panel.flags.fb_in_psram != 1) return 3;
    return 0;
}

int main(void) {
    SimpleConfig cfg = (SimpleConfig){ .value = 99, .flags = { .flag_b = 1 } };
    int32_t result = check_simple(cfg);
    if (result != 0) return result;
    DisplayConfig disp = (DisplayConfig){ .resolution = { .width = 1024, .height = 768 }, .settings = { .brightness = 100, .contrast = 75 } };
    result = check_display(disp);
    if (result != 0) return 10 + result;
    PanelConfig panel = (PanelConfig){ .clk_src = 1, .timings = { .pclk_hz = 16000000, .h_res = 800, .v_res = 480 }, .flags = { .fb_in_psram = 1, .double_fb = 0 } };
    result = check_panel(panel);
    if (result != 0) return 20 + result;
    return 0;
}
