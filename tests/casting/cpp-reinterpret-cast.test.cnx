// test-execution
/* test-no-warnings */
// Tests: Issue #267 - reinterpret_cast for string-to-pointer in C++ mode
// When cppMode is enabled, passing string bytes to u8 parameters should
// use reinterpret_cast<uint8_t*> instead of C-style (uint8_t*) cast
#include "cpp-cast-mode.hpp"

scope ByteProcessor {
    u32 processByte(u32 crc, u8 byte) {
        return crc ^ byte;
    }

    public u32 processBuffer() {
        string<4> buf <- "ABCD";
        u32 crc <- 0;

        // These should generate reinterpret_cast in C++ mode
        crc <- this.processByte(crc, buf[0]);
        crc <- this.processByte(crc, buf[1]);

        return crc;
    }
}

u32 main() {
    // Expected: 0 ^ 0x41 ^ 0x42 = 0x03
    u32 result <- ByteProcessor.processBuffer();
    if (result != 0x03) return 1;

    return 0;
}
