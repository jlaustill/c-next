/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>

// test-execution
// Tests: MISRA C:2012 Rule 16.4 - Every switch shall have a default
// Issue: #855
// Verifies: Switches without explicit default get an auto-generated one
typedef enum {
    Status_OK = 0,
    Status_ERROR = 1,
    Status_PENDING = 2
} Status;

// Exhaustive enum switch - no explicit default in source
// MISRA 16.4 requires a default case anyway
uint32_t getStatusCode(Status s) {
    uint32_t code = 0U;
    switch (s) {
        case Status_OK: {
            code = 1U;
            break;
        }
        case Status_ERROR: {
            code = 2U;
            break;
        }
        case Status_PENDING: {
            code = 3U;
            break;
        }
        default: {
            break;
        }
    }
    return code;
}

// Integer switch without default
// MISRA 16.4 requires a default case
uint32_t mapValue(uint32_t val) {
    uint32_t result = 99U;
    switch (val) {
        case 1: {
            result = 10U;
            break;
        }
        case 2: {
            result = 20U;
            break;
        }
        case 3: {
            result = 30U;
            break;
        }
        default: {
            break;
        }
    }
    return result;
}

// Switch WITH explicit default - should work as before
uint32_t withDefault(uint32_t val) {
    uint32_t result = 0U;
    switch (val) {
        case 1: {
            result = 100U;
            break;
        }
        default: {
            result = 999U;
            break;
        }
    }
    return result;
}

int main(void) {
    uint32_t result = 0U;
    result = getStatusCode(Status_OK);
    if (result != 1) return 1;
    result = getStatusCode(Status_ERROR);
    if (result != 2) return 2;
    result = getStatusCode(Status_PENDING);
    if (result != 3) return 3;
    result = mapValue(1U);
    if (result != 10) return 4;
    result = mapValue(2U);
    if (result != 20) return 5;
    result = mapValue(3U);
    if (result != 30) return 6;
    result = mapValue(999U);
    if (result != 99) return 7;
    result = withDefault(1U);
    if (result != 100) return 8;
    result = withDefault(5U);
    if (result != 999) return 9;
    return 0;
}
