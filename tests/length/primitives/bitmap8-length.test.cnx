// test-execution
// Comprehensive .length test for bitmap8 type across all contexts
// Tests: .length returns 8 for bitmap8 in every possible scope and access pattern
// Define bitmap8 type
bitmap8 StatusFlags {
    bit0,
    bit1,
    bit2,
    bit3,
    bit4,
    bit5,
    bit6,
    bit7
}

StatusFlags globalVar;

scope TestScope {
    public u32 getGlobalLength() {
        return global.globalVar.length;
    }
    StatusFlags scopeMember;
    public u32 getMemberLength() {
        return this.scopeMember.length;
    }
    public StatusFlags publicMember;
}

u32 checkParamLength(StatusFlags param) {
    return param.length;
}

struct TestStruct {
    StatusFlags member;
}

i32 main() {
    globalVar.bit0 <- true;

    if (globalVar.length != 8) {
        return 1;
    }

    u32 result <- TestScope.getGlobalLength();
    if (result != 8) {
        return 2;
    }

    result <- TestScope.getMemberLength();
    if (result != 8) {
        return 3;
    }

    if (TestScope.publicMember.length != 8) {
        return 4;
    }

    StatusFlags localVar;
    localVar.bit0 <- true;
    if (localVar.length != 8) {
        return 5;
    }

    StatusFlags testVal;
    testVal.bit0 <- true;
    result <- checkParamLength(testVal);
    if (result != 8) {
        return 6;
    }

    // Issue #196 Bug 2 test: Array element .length no longer triggers false positive
    // Previously this would cause: "use of uninitialized variable 'arr'"
    // Since .length is a compile-time type property, no init check is needed
    StatusFlags arr[4];
    if (arr[0].length != 8) {
        return 8;
    }

    return 0;
}
