/**
 * Generated by C-Next Transpiler from: clamp-u8.test.cnx
 * A safer C for embedded systems
 */

#include <stdint.h>

// ADR-044: Overflow helper functions
#include <limits.h>

static inline uint8_t cnx_clamp_add_u8(uint8_t a, uint32_t b) {
    if (b > (uint32_t)(UINT8_MAX - a)) return UINT8_MAX;
    uint8_t result;
    if (__builtin_add_overflow(a, (uint8_t)b, &result)) return UINT8_MAX;
    return result;
}

static inline uint8_t cnx_clamp_sub_u8(uint8_t a, uint32_t b) {
    if (b > (uint32_t)a) return 0;
    uint8_t result;
    if (__builtin_sub_overflow(a, (uint8_t)b, &result)) return 0;
    return result;
}

// test-execution
// Tests: clamp modifier for u8 type (0 to 255)
// Validates overflow clamps to 255, underflow clamps to 0
// ADR-044: Per-variable overflow semantics
int main(void) {
    uint8_t val = 200U;
    val = cnx_clamp_add_u8(val, 100U);
    if (val != 255) return 1;
    val = 255U;
    val = cnx_clamp_add_u8(val, 1U);
    if (val != 255) return 2;
    val = 100U;
    val = cnx_clamp_add_u8(val, 200U);
    if (val != 255) return 3;
    val = 1U;
    val = cnx_clamp_add_u8(val, 255U);
    if (val != 255) return 4;
    val = 250U;
    val = cnx_clamp_add_u8(val, 10U);
    if (val != 255) return 5;
    val = cnx_clamp_add_u8(val, 10U);
    if (val != 255) return 6;
    val = 50U;
    val = cnx_clamp_sub_u8(val, 100U);
    if (val != 0) return 7;
    val = 0U;
    val = cnx_clamp_sub_u8(val, 1U);
    if (val != 0) return 8;
    val = 10U;
    val = cnx_clamp_sub_u8(val, 255U);
    if (val != 0) return 9;
    val = 5U;
    val = cnx_clamp_sub_u8(val, 10U);
    if (val != 0) return 10;
    val = cnx_clamp_sub_u8(val, 10U);
    if (val != 0) return 11;
    val = 100U;
    val = cnx_clamp_add_u8(val, 50U);
    if (val != 150) return 12;
    val = 200U;
    val = cnx_clamp_sub_u8(val, 50U);
    if (val != 150) return 13;
    val = 0U;
    val = cnx_clamp_add_u8(val, 100U);
    if (val != 100) return 14;
    val = 100U;
    val = cnx_clamp_sub_u8(val, 100U);
    if (val != 0) return 15;
    val = 254U;
    val = cnx_clamp_add_u8(val, 1U);
    if (val != 255) return 16;
    val = 1U;
    val = cnx_clamp_sub_u8(val, 1U);
    if (val != 0) return 17;
    val = 128U;
    val = cnx_clamp_add_u8(val, 0U);
    if (val != 128) return 18;
    val = 128U;
    val = cnx_clamp_sub_u8(val, 0U);
    if (val != 128) return 19;
    val = 200U;
    val = cnx_clamp_add_u8(val, 100U);
    if (val != 255) return 20;
    val = cnx_clamp_sub_u8(val, 255U);
    if (val != 0) return 21;
    val = 250U;
    val = cnx_clamp_add_u8(val, 2U);
    if (val != 252) return 22;
    val = cnx_clamp_add_u8(val, 2U);
    if (val != 254) return 23;
    val = cnx_clamp_add_u8(val, 2U);
    if (val != 255) return 24;
    val = 5U;
    val = cnx_clamp_sub_u8(val, 2U);
    if (val != 3) return 25;
    val = cnx_clamp_sub_u8(val, 2U);
    if (val != 1) return 26;
    val = cnx_clamp_sub_u8(val, 2U);
    if (val != 0) return 27;
    return 0;
}
