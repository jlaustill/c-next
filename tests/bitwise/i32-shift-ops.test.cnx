/* test-coverage: 5.5-i32-left-shift, 5.6-i32-right-shift-arithmetic */ /* test-execution */ // Test i32 shift operations: arithmetic right shift preserves sign
// Coverage: Section 5.5-5.6 for i32 type (ADR-044)
u32 main() {
    // Left shift - logical
    i32 a <- 1;
    i32 left1 <- a << 1; // 2
    i32 left16 <- a << 16; // 65536
    i32 left30 <- a << 30; // 1073741824

    // Right shift on positive
    i32 b <- 1073741824; // 0x40000000
    i32 right1 <- b >> 1; // 0x20000000 = 536870912
    i32 right16 <- b >> 16; // 0x00004000 = 16384
    i32 right30 <- b >> 30; // 0x00000001 = 1

    // Right shift on negative - sign extension
    i32 c <- -1073741824; // 0xC0000000 (two's complement)
    i32 neg_right1 <- c >> 1; // 0xE0000000 = -536870912
    i32 neg_right16 <- c >> 16; // 0xFFFFC000 = -16384
    i32 neg_right30 <- c >> 30; // 0xFFFFFFFF = -1

    // Edge case: shift -1 (all bits set)
    i32 minus_one <- -1;
    i32 shift_minus_one <- minus_one >> 16; // Still -1

    // Shift by variable
    i32 d <- 256;
    i32 shift_amount <- 4;
    i32 left_var <- d << shift_amount; // 4096
    i32 right_var <- d >> shift_amount; // 16

    // Complex: negative shift
    i32 e <- -65536;
    i32 neg_shift <- e >> 8; // -256 (sign preserved)

    // Verify results
    if (left1 = 2 && left16 = 65536 && left30 = 1073741824) {
        if (right1 = 536870912 && right16 = 16384 && right30 = 1) {
            if (neg_right1 = -536870912 && neg_right16 = -16384 && neg_right30 = -1) {
                if (shift_minus_one = -1 && left_var = 4096 && right_var = 16) {
                    if (neg_shift = -256) {
                        return 0;
                    }
                }
            }
        }
    }
    return 1;
}
