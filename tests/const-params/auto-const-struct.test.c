/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// test-execution
// Tests: Auto-const inference for struct parameters
// Coverage: Struct parameters get const when not modified
typedef struct Point {
    int32_t x;
    int32_t y;
} Point;

typedef struct Config {
    uint32_t value;
    bool enabled;
} Config;

// Read-only struct parameter - should get const
int32_t getPointSum(const Point* p) {
    return p->x + p->y;
}

// Modified struct parameter - should NOT get const
void movePoint(Point* p, int32_t dx, int32_t dy) {
    p->x += dx;
    p->y += dy;
}

// Read-only config - should get const
uint32_t getConfigValue(const Config* c) {
    return c->value;
}

// Mixed: read one field, modify another - should NOT get const
void toggleAndRead(Config* c) {
    uint32_t temp = c->value;
    c->enabled = !c->enabled;
}

// Pass through to read-only - should get const
int32_t wrapGetSum(const Point* p) {
    return getPointSum(p);
}

// Pass through to modifier - should NOT get const
void wrapMovePoint(Point* p) {
    movePoint(p, 1, 1);
}

int main(void) {
    Point pt = (Point){ .x = 10, .y = 20 };
    int32_t sum = getPointSum(&pt);
    if (sum != 30) return 1;
    if (pt.x != 10) return 2;
    if (pt.y != 20) return 3;
    movePoint(&pt, 5, -3);
    if (pt.x != 15) return 4;
    if (pt.y != 17) return 5;
    Config cfg = (Config){ .value = 42, .enabled = true };
    uint32_t val = getConfigValue(&cfg);
    if (val != 42) return 6;
    toggleAndRead(&cfg);
    if (cfg.enabled != false) return 7;
    Point pt2 = (Point){ .x = 100, .y = 200 };
    sum = wrapGetSum(&pt2);
    if (sum != 300) return 8;
    if (pt2.x != 100) return 9;
    wrapMovePoint(&pt2);
    if (pt2.x != 101) return 10;
    if (pt2.y != 201) return 11;
    return 0;
}
