// test-execution
// Tests .bit_length property for arrays (ADR-058)
// bit_length returns total bits of storage (elements x element bit width)
// u32[16] = 16 elements x 32 bits = 512 bits

u32[16] globalArr;

scope TestScope {
    public u32 getGlobalArrayBitLength() {
        return global.globalArr.bit_length;
    }
    u32[16] scopeArr;
    public u32 getScopeArrayBitLength() {
        return this.scopeArr.bit_length;
    }
    public u32 publicArr[16];
}

u32 checkArrayBitLength(u32[16] arr) {
    return arr.bit_length;
}

struct TestStruct {
    u32[16] arr;
}

i32 main() {
    globalArr[0] <- 100000;

    // Test global array bit_length = 512 (16 x 32)
    if (globalArr.bit_length != 512) {
        return 1;
    }

    // Test via scope function
    u32 result <- TestScope.getGlobalArrayBitLength();
    if (result != 512) {
        return 2;
    }

    result <- TestScope.getScopeArrayBitLength();
    if (result != 512) {
        return 3;
    }

    // Test public scope array
    if (TestScope.publicArr.bit_length != 512) {
        return 4;
    }

    // Test local array
    u32[16] localArr;
    localArr[0] <- 100000;
    if (localArr.bit_length != 512) {
        return 5;
    }

    // Test parameter
    u32[16] testArr;
    testArr[0] <- 100000;
    result <- checkArrayBitLength(testArr);
    if (result != 512) {
        return 6;
    }

    // Test struct member array
    TestStruct ts;
    ts.arr[0] <- 100000;
    if (ts.arr.bit_length != 512) {
        return 7;
    }

    // Test element bit_length (single element = 32 bits)
    if (globalArr[0].bit_length != 32) {
        return 8;
    }

    return 0;
}
