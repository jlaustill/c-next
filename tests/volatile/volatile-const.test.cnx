/* test-execution */
/* test-coverage: 30a-volatile-const */
// Tests: Volatile + const combination
// ADR-108: Hardware status register pattern (read-only volatile)

// Const volatile - can be read but not modified by this code
// Used for hardware status registers that change externally
const volatile u32 hardware_status <- 0x0000FFFF;

u32 main() {
    // Test 1: Read const volatile
    u32 status <- hardware_status;
    if (status != 0x0000FFFF) return 1;

    // Test 2: Multiple reads (should not be optimized away)
    u32 read1 <- hardware_status;
    u32 read2 <- hardware_status;
    u32 read3 <- hardware_status;

    // All reads should return same value (since we initialized it)
    if (read1 != 0x0000FFFF) return 2;
    if (read2 != 0x0000FFFF) return 3;
    if (read3 != 0x0000FFFF) return 4;

    // Test 3: Const volatile in expression
    u32 masked <- hardware_status & 0x00FF;
    if (masked != 0x00FF) return 5;

    // Test 4: Local const volatile
    const volatile u32 local_status <- 42;
    if (local_status != 42) return 6;

    return 0;  // All tests passed
}
