/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <string.h>

// test-execution
/* test-no-warnings */
// Tests: Issue #246 - string<N> byte indexing to u8 function parameters
// When passing buf[0] directly to a function expecting u8, the generated
// C has a type mismatch: char* (from string) vs uint8_t* (function param)
// Note: This fix also applies to other integer types (u16, u32, i8, etc.)
// u8 is the most common use case for byte-by-byte string processing
/* Scope: ByteProcessor */

static uint32_t ByteProcessor_processByte(uint32_t* crc, uint8_t* byte) {
    return (*crc) ^ (*byte);
}

uint32_t ByteProcessor_processBuffer(void) {
    char buf[5] = "ABCD";
    uint32_t crc = 0;
    crc = ByteProcessor_processByte(&crc, (uint8_t*)&buf[0]);
    crc = ByteProcessor_processByte(&crc, (uint8_t*)&buf[1]);
    crc = ByteProcessor_processByte(&crc, (uint8_t*)&buf[2]);
    crc = ByteProcessor_processByte(&crc, (uint8_t*)&buf[3]);
    return crc;
}

int main(void) {
    uint32_t result = ByteProcessor_processBuffer();
    if (result != 0x04) return 1;
    return 0;
}
