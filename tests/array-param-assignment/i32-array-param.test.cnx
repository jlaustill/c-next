// test-execution
// Tests: i32 array parameter assignment
// Coverage: Signed integer array parameters with negative values

// Write to unsized array
void writeI32(i32 arr[], u32 index, i32 value) {
    arr[index] <- value;
}

// Write to sized array
void writeI32Sized(i32 arr[4], u32 index, i32 value) {
    arr[index] <- value;
}

// Read from array
i32 readI32(i32 arr[], u32 index) {
    return arr[index];
}

// Negate array element
void negateI32(i32 arr[], u32 index) {
    arr[index] <- -arr[index];
}

// Add to array element
void addToI32(i32 arr[], u32 index, i32 delta) {
    arr[index] +<- delta;
}

u32 main() {
    // Test positive values
    i32 buffer[4];
    buffer[0] <- 0;
    buffer[1] <- 0;
    buffer[2] <- 0;
    buffer[3] <- 0;

    writeI32(buffer, 0, 12345);
    if (buffer[0] != 12345) return 1;

    // Test negative values
    writeI32(buffer, 1, -9999);
    if (buffer[1] != -9999) return 2;

    // Test sized parameter with negative value
    writeI32Sized(buffer, 2, -2147483648);
    if (buffer[2] != -2147483648) return 3;

    // Test max positive value
    writeI32Sized(buffer, 3, 2147483647);
    if (buffer[3] != 2147483647) return 4;

    // Test read through parameter
    i32 result <- readI32(buffer, 1);
    if (result != -9999) return 5;

    result <- readI32(buffer, 3);
    if (result != 2147483647) return 6;

    // Test negate operation
    buffer[0] <- 100;
    negateI32(buffer, 0);
    if (buffer[0] != -100) return 7;

    negateI32(buffer, 0);
    if (buffer[0] != 100) return 8;

    // Test compound add with negative delta
    buffer[1] <- 50;
    addToI32(buffer, 1, -30);
    if (buffer[1] != 20) return 9;

    addToI32(buffer, 1, -25);
    if (buffer[1] != -5) return 10;

    return 0;
}
