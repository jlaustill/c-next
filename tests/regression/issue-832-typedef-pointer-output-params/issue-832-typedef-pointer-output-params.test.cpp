/**
 * Generated by C-Next Transpiler from: issue-832-typedef-pointer-output-params.test.cnx
 * A safer C for embedded systems
 */

// test-execution
// test-cpp-only
// Issue #832: Auto-reference (&) not added for typedef pointer output parameters
//
// When a typedef is defined as a pointer (typedef struct_t* handle_t), and a function
// expects handle_t* as an output parameter, the transpiler should add & when passing
// a handle_t variable.
//
// Example: create_handle expects (handle_t*), my_handle is handle_t
// Correct:   create_handle(&my_handle)
// Bug:       create_handle(my_handle)   <- missing &
#include "issue-832-typedef-pointer-output-params.hpp"

#include <stdint.h>

handle_t my_handle = {};

int main(void) {
    create_handle(&my_handle);
    int32_t val = use_handle(my_handle);
    if (val != 42) return 1;
    replace_handle(&my_handle);
    val = use_handle(my_handle);
    if (val != 100) return 2;
    return 0;
}
