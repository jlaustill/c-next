// test-c-only
// ADR-050: Critical section with multiple variables
// Tests: multiple variables protected in one critical section
u32 readIdx <- 0;

u32 writeIdx <- 0;

u8[64] buffer;

void transfer() {
    critical {
        u8 data <- buffer[readIdx];
        readIdx +<- 1;
        buffer[writeIdx] <- data;
        writeIdx +<- 1;
    }
}
