/**
 * Generated by C-Next Transpiler from: basic-bitmap.test.cnx
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// ADR-034: Basic Bitmap Test
// Tests bitmap declaration, field access, and code generation
// 8-bit bitmap with various field widths
/* Bitmap: MotorFlags */
/* Fields:
 *   Running: bit 0 (1 bit)
 *   Direction: bit 1 (1 bit)
 *   Fault: bit 2 (1 bit)
 *   Mode: bits 3-5 (3 bits)
 *   Reserved: bits 6-7 (2 bits)
 */
typedef uint8_t MotorFlags;

// Variable declaration
MotorFlags flags = 0;

int main(void) {
    flags = (flags & ~(1U << 0)) | (1U << 0);
    flags = (flags & ~(1U << 1)) | (0U << 1);
    flags = (flags & ~(1U << 2)) | (1U << 2);
    flags = (flags & ~(0x7U << 3)) | ((5 & 0x7U) << 3);
    bool isRunning = ((((flags >> 0) & 1)) != 0U);
    bool hasFault = ((((flags >> 2) & 1)) != 0U);
    uint8_t mode = (uint8_t)((flags >> 3) & 0x7);
    if (((flags >> 0) & 1) == true) {
        flags = (flags & ~(0x7U << 3)) | ((3 & 0x7U) << 3);
    }
    uint8_t doubleMode = (uint8_t)((flags >> 3) & 0x7) * 2U;
}
