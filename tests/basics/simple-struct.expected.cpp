/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// test-execution
// Tests: Basic struct definition and usage
// Demonstrates: struct definition, field access, initialization, pass-by-reference
// Simple struct definition
typedef struct Point {
    int32_t x;
    int32_t y;
} Point;

// Struct with different field types
typedef struct Sensor {
    uint16_t id;
    float temperature;
    bool active;
} Sensor;

// Function that reads struct fields (pass-by-reference, ADR-006)
int32_t getPointX(const Point& p) {
    return p.x;
}

// Function that modifies struct (pass-by-reference modifies original)
void setPointOrigin(Point& p) {
    p.x = 0;
    p.y = 0;
}

// Function that uses struct values
int32_t manhattanDistance(const Point& p) {
    int32_t absX = p.x;
    if (absX < 0) {
        absX = 0 - absX;
    }
    int32_t absY = p.y;
    if (absY < 0) {
        absY = 0 - absY;
    }
    return absX + absY;
}

int main(void) {
    Point origin = (Point){ .x = 0, .y = 0 };
    if (origin.x != 0) return 1;
    if (origin.y != 0) return 2;
    Point p1 = {0};
    p1.x = 10;
    p1.y = 20;
    if (p1.x != 10) return 3;
    if (p1.y != 20) return 4;
    Point p2 = (Point){ .x = 5, .y = -3 };
    if (p2.x != 5) return 5;
    if (p2.y != -3) return 6;
    int32_t xVal = getPointX(p2);
    if (xVal != 5) return 7;
    Point p3 = (Point){ .x = 100, .y = 200 };
    setPointOrigin(p3);
    if (p3.x != 0) return 8;
    if (p3.y != 0) return 9;
    Point p4 = (Point){ .x = -3, .y = 4 };
    int32_t dist = manhattanDistance(p4);
    if (dist != 7) return 10;
    Sensor s1 = (Sensor){ .id = 42, .temperature = 23.5, .active = true };
    if (s1.id != 42) return 11;
    if (s1.active != true) return 12;
    return 0;
}
