/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// test-coverage: 11-bitmap-struct-member
// test-execution
// Tests: Bitmap as struct member
/* Bitmap: Flags */
/* Fields:
 *   Active: bit 0 (1 bit)
 *   Ready: bit 1 (1 bit)
 *   Error: bit 2 (1 bit)
 *   Mode: bits 3-7 (5 bits)
 */
typedef uint8_t Flags;

/* Bitmap: Status */
/* Fields:
 *   Running: bit 0 (1 bit)
 *   Paused: bit 1 (1 bit)
 *   Complete: bit 2 (1 bit)
 *   Reserved: bits 3-7 (5 bits)
 *   Progress: bits 8-15 (8 bits)
 */
typedef uint16_t Status;

typedef struct Device {
    uint32_t id;
    Flags flags;
    Status status;
    uint32_t value;
} Device;

typedef struct Controller {
    Flags controlFlags;
    uint32_t counter;
} Controller;

Device device = {0};

Controller ctrl = {0};

int main(void) {
    device.id = 12345U;
    device.value = 100U;
    device.flags = (device.flags & ~(1 << 0)) | (1 << 0);
    device.flags = (device.flags & ~(1 << 1)) | (1 << 1);
    device.flags = (device.flags & ~(1 << 2)) | (0 << 2);
    if (((device.flags >> 0) & 1) != true) return 1;
    if (((device.flags >> 1) & 1) != true) return 2;
    if (((device.flags >> 2) & 1) != false) return 3;
    device.flags = (device.flags & ~(0x1F << 3)) | ((15 & 0x1F) << 3);
    if (((device.flags >> 3) & 0x1F) != 15) return 4;
    device.status = (device.status & ~(1 << 0)) | (1 << 0);
    device.status = (device.status & ~(1 << 1)) | (0 << 1);
    device.status = (device.status & ~(1 << 2)) | (0 << 2);
    device.status = (device.status & ~(0xFF << 8)) | ((50 & 0xFF) << 8);
    if (((device.status >> 0) & 1) != true) return 5;
    if (((device.status >> 1) & 1) != false) return 6;
    if (((device.status >> 8) & 0xFF) != 50) return 7;
    if (device.id != 12345) return 8;
    if (device.value != 100) return 9;
    ctrl.counter = 999U;
    ctrl.controlFlags = (ctrl.controlFlags & ~(1 << 0)) | (1 << 0);
    ctrl.controlFlags = (ctrl.controlFlags & ~(0x1F << 3)) | ((7 & 0x1F) << 3);
    if (((ctrl.controlFlags >> 0) & 1) != true) return 10;
    if (((ctrl.controlFlags >> 3) & 0x1F) != 7) return 11;
    if (ctrl.counter != 999) return 12;
    device.status = (device.status & ~(0xFF << 8)) | ((100 & 0xFF) << 8);
    device.status = (device.status & ~(1 << 2)) | (1 << 2);
    if (((device.status >> 8) & 0xFF) != 100) return 13;
    if (((device.status >> 2) & 1) != true) return 14;
    if (((device.status >> 0) & 1) != true) return 15;
    bool isActive = ((device.flags >> 0) & 1);
    if (isActive != true) return 16;
    uint8_t progress = ((device.status >> 8) & 0xFF);
    if (progress != 100) return 17;
    uint8_t mode = ((device.flags >> 3) & 0x1F);
    if (mode != 15) return 18;
    return 0;
}
