/**
 * Generated by C-Next Transpiler from: safe-div-preserve-on-error.test.cnx
 * A safer C for embedded systems
 */

#include <stdint.h>
#include <stdbool.h>

// ADR-051: Safe division helper functions
#include <stdbool.h>

static inline bool cnx_safe_div_u32(uint32_t* output, uint32_t numerator, uint32_t divisor, uint32_t defaultValue) {
    if (divisor == 0) {
        *output = defaultValue;
        return true;  // Error occurred
    }
    *output = numerator / divisor;
    return false;  // Success
}

// ADR-051: Safe division - preserve current value on error
// Demonstrates the pattern for preserving state when division fails
// Example: speed <- distance / time (if time is zero, speed shouldn't change)
void testPreserveSpeedOnZeroTime(void) {
    uint32_t speed = 60U;
    uint32_t distance = 120U;
    uint32_t time = 0U;
    bool err = false;
    err = cnx_safe_div_u32(&speed, distance, time, speed);
}

void testPreserveMultipleValues(void) {
    uint32_t avgTemp = 72U;
    uint32_t totalTemp = 500U;
    uint32_t sampleCount = 0U;
    bool err = false;
    err = cnx_safe_div_u32(&avgTemp, totalTemp, sampleCount, avgTemp);
}

void testUpdateOnSuccess(void) {
    uint32_t value = 50U;
    bool err = false;
    err = cnx_safe_div_u32(&value, 100, 2, value);
}
