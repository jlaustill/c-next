/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include "test.h"

// Bug: Array indexing on global external struct field generates bit-slice code
//
// Expected: globalExt.data[1]
// Actual:   ((globalExt.data >> 1) & 1)
//
// Note: When passed as parameter, array indexing works correctly.
// The bug only occurs when accessing via global. prefix.
#include "External.h"

#include <stdint.h>

ExternalStruct globalExt = {0};

/* Scope: Test */

uint8_t Test_getBroken(void) {
    return globalExt.data[1];
}

uint8_t Test_getWorking(const ExternalStruct* ext) {
    return ext->data[1];
}
