/**
 * Generated by C-Next Transpiler
 * A safer C for embedded systems
 */

#include <stdint.h>

// Example: RGB565 Color Manipulation
// test-execution
//
// Demonstrates C-Next's bit indexing syntax with a real-world use case.
// RGB565 is a common 16-bit color format used in embedded displays,
// game consoles, and graphics applications.
//
// Format (16 bits total):
//   Bits 15-11: Red   (5 bits, values 0-31)
//   Bits 10-5:  Green (6 bits, values 0-63)
//   Bits 4-0:   Blue  (5 bits, values 0-31)
//
// Fun fact: Green gets an extra bit because the human eye has more
// green-sensitive cone cells, so displays allocate more precision
// to green for better perceived color quality.
//
// C-Next syntax:  pixel[start, width]
// Meaning:        "width bits starting at bit position start"
int main(void) {
    uint16_t pixel = 0x7BEF;
    uint8_t red = ((pixel >> 11) & ((1U << 5) - 1));
    uint8_t green = ((pixel >> 5) & ((1U << 6) - 1));
    uint8_t blue = ((pixel) & ((1U << 5) - 1));
    if (red != 15) return 1;
    if (green != 31) return 2;
    if (blue != 15) return 3;
    uint16_t pureRed = 0xF800;
    if (((pureRed >> 11) & ((1U << 5) - 1)) != 31) return 4;
    if (((pureRed >> 5) & ((1U << 6) - 1)) != 0) return 5;
    if (((pureRed) & ((1U << 5) - 1)) != 0) return 6;
    uint16_t pureGreen = 0x07E0;
    if (((pureGreen >> 11) & ((1U << 5) - 1)) != 0) return 7;
    if (((pureGreen >> 5) & ((1U << 6) - 1)) != 63) return 8;
    if (((pureGreen) & ((1U << 5) - 1)) != 0) return 9;
    uint16_t pureBlue = 0x001F;
    if (((pureBlue >> 11) & ((1U << 5) - 1)) != 0) return 10;
    if (((pureBlue >> 5) & ((1U << 6) - 1)) != 0) return 11;
    if (((pureBlue) & ((1U << 5) - 1)) != 31) return 12;
    uint16_t modified = 0x7BEF;
    modified = (modified & ~(((1U << 6) - 1) << 5)) | ((63 & ((1U << 6) - 1)) << 5);
    if (((modified >> 11) & ((1U << 5) - 1)) != 15) return 13;
    if (((modified >> 5) & ((1U << 6) - 1)) != 63) return 14;
    if (((modified) & ((1U << 5) - 1)) != 15) return 15;
    uint16_t custom = 0;
    custom = (custom & ~(((1U << 5) - 1) << 11)) | ((31 & ((1U << 5) - 1)) << 11);
    custom = (custom & ~(((1U << 6) - 1) << 5)) | ((32 & ((1U << 6) - 1)) << 5);
    custom = (custom & ~(((1U << 5) - 1) << 0)) | ((16 & ((1U << 5) - 1)) << 0);
    if (((custom >> 11) & ((1U << 5) - 1)) != 31) return 16;
    if (((custom >> 5) & ((1U << 6) - 1)) != 32) return 17;
    if (((custom) & ((1U << 5) - 1)) != 16) return 18;
    if (custom != 0xFC10) return 19;
    return 0;
}
