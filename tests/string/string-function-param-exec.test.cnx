// test-execution
// ADR-045: Validate string function parameters at runtime
u32 getLen(const string<64> s) {
    return s.char_count;
}

u32 getCap(const string<64> s) {
    return s.capacity;
}

bool isEqual(const string<64> a, const string<64> b) {
    return a = b;
}

bool matchesLiteral(const string<64> s, const string<64> lit) {
    return s = lit;
}

i32 main() {
    string<64> test <- "Hello";

   
// Test 1-3: Get length via function
    u32 len1 <- getLen(test);
    if (len1 != 5) return 1;
    u32 len2 <- getLen("World");
    if (len2 != 5) return 2;
    u32 len3 <- getLen("");
    if (len3 != 0) return 3;

   
// Test 4-5: Get capacity via function
    u32 cap1 <- getCap(test);
    if (cap1 != 64) return 4;

    // Note: Literal passed to const string<64> param gets capacity 64
    u32 cap2 <- getCap("Hi");
    if (cap2 != 64) return 5;

   
// Test 6-8: Comparison via function
    string<64> same <- "Hello";
    bool eq1 <- isEqual(test, same);
    if (!eq1) return 6;
    bool eq2 <- isEqual(test, "Hello");
    if (!eq2) return 7;

    string<64> diff <- "World";
    bool eq3 <- isEqual(test, diff);
    if (eq3) return 8;

   
// Test 9-10: Literal matching
    bool match1 <- matchesLiteral(test, "Hello");
    if (!match1) return 9;
    bool match2 <- matchesLiteral(test, "World");
    if (match2) return 10;

   
// Test 11-12: Empty string as parameter
    string<64> empty;
    u32 emptyLen <- getLen(empty);
    if (emptyLen != 0) return 11;
    bool emptyEq <- isEqual(empty, "");
    if (!emptyEq) return 12;

   
// Test 13-14: Longer string parameter
    string<64> longer <- "This is a longer string";
    u32 longerLen <- getLen(longer);
    if (longerLen != 23) return 13;
    bool longerMatch <- matchesLiteral(longer, "This is a longer string");
    if (!longerMatch) return 14;

    return 0;
}
