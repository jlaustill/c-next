// test-execution
// Test: ADR-016 Modifiers in public and private method contexts
// Verifies that this. and global. accessors work correctly in all method contexts
// Tests: public methods, private methods, local variables with modifiers, combined access patterns

// Global variables for testing global. accessor in all method contexts
const u8 GLOBAL_MAX <- 100;
const u16 GLOBAL_THRESHOLD <- 1000;
u8 globalCounter <- 50;
bool globalEnabled <- true;
i16 globalOffset <- -25;
f32 globalScale <- 2.5;

scope MethodContexts {
    // Scope-level variables - private (default)
    u8 privateValue <- 10;
    clamp u8 privateClampValue <- 200;
    wrap u8 privateWrapValue <- 250;
    bool privateFlag <- false;
    i16 privateOffset <- -50;

    // Scope-level variables - public
    public u8 publicValue <- 20;
    public clamp u16 publicClampValue <- 60000;
    public wrap u16 publicWrapValue <- 65530;
    public bool publicFlag <- true;
    public i32 publicOffset <- -1000;

    // ========================================
    // PRIVATE METHODS - this. accessor tests
    // ========================================

    // Private method: basic this. access to private members
    u8 getPrivateValue() {
        return this.privateValue;
    }

    // Private method: basic this. access to public members
    u8 getPublicValueInternal() {
        return this.publicValue;
    }

    // Private method: this. with clamp modifier
    u8 getPrivateClampValue() {
        return this.privateClampValue;
    }

    // Private method: this. with wrap modifier
    u8 getPrivateWrapValue() {
        return this.privateWrapValue;
    }

    // Private method: this. modify private clamp variable
    void incrementPrivateClamp() {
        this.privateClampValue +<- 100;  // Clamps at 255
    }

    // Private method: this. modify private wrap variable
    void incrementPrivateWrap() {
        this.privateWrapValue +<- 10;  // Wraps around
    }

    // Private method: boolean this. access
    bool getPrivateFlag() {
        return this.privateFlag;
    }

    // Private method: signed integer this. access
    i16 getPrivateOffset() {
        return this.privateOffset;
    }

    // ========================================
    // PRIVATE METHODS - global. accessor tests
    // ========================================

    // Private method: global. access to const global
    u8 getGlobalMaxInternal() {
        return global.GLOBAL_MAX;
    }

    // Private method: global. access to mutable global
    u8 getGlobalCounterInternal() {
        return global.globalCounter;
    }

    // Private method: global. access to bool global
    bool getGlobalEnabledInternal() {
        return global.globalEnabled;
    }

    // Private method: global. access to signed global
    i16 getGlobalOffsetInternal() {
        return global.globalOffset;
    }

    // Private method: global. access to float global
    f32 getGlobalScaleInternal() {
        return global.globalScale;
    }

    // ========================================
    // PRIVATE METHODS - combined this. and global.
    // ========================================

    // Private method: combine scope and global values
    u8 computePrivateSum() {
        return this.privateValue + global.globalCounter;
    }

    // Private method: compare scope and global values
    bool privateValueBelowMax() {
        return this.privateValue < global.GLOBAL_MAX;
    }

    // Private method: offset calculation using this. and global.
    i16 computePrivateWithOffset() {
        return this.privateOffset + global.globalOffset;
    }

    // ========================================
    // PUBLIC METHODS - this. accessor tests
    // ========================================

    // Public method: basic this. access to private members
    public u8 getPrivateValueExternal() {
        return this.privateValue;
    }

    // Public method: basic this. access to public members
    public u8 getPublicValue() {
        return this.publicValue;
    }

    // Public method: this. with clamp modifier on public variable
    public u16 getPublicClampValue() {
        return this.publicClampValue;
    }

    // Public method: this. with wrap modifier on public variable
    public u16 getPublicWrapValue() {
        return this.publicWrapValue;
    }

    // Public method: this. modify public clamp variable
    public void incrementPublicClamp() {
        this.publicClampValue +<- 10000;  // Clamps at 65535
    }

    // Public method: this. modify public wrap variable
    public void incrementPublicWrap() {
        this.publicWrapValue +<- 10;  // Wraps around
    }

    // Public method: boolean this. access
    public bool getPublicFlag() {
        return this.publicFlag;
    }

    // Public method: signed integer this. access
    public i32 getPublicOffset() {
        return this.publicOffset;
    }

    // Public method: set private value via this.
    public void setPrivateValue(u8 val) {
        this.privateValue <- val;
    }

    // Public method: set public value via this.
    public void setPublicValue(u8 val) {
        this.publicValue <- val;
    }

    // Public method: set private flag via this.
    public void setPrivateFlag(bool val) {
        this.privateFlag <- val;
    }

    // Public method: set public flag via this.
    public void setPublicFlag(bool val) {
        this.publicFlag <- val;
    }

    // ========================================
    // PUBLIC METHODS - global. accessor tests
    // ========================================

    // Public method: global. access to const global
    public u8 getGlobalMax() {
        return global.GLOBAL_MAX;
    }

    // Public method: global. access to threshold
    public u16 getGlobalThreshold() {
        return global.GLOBAL_THRESHOLD;
    }

    // Public method: global. access to mutable global
    public u8 getGlobalCounter() {
        return global.globalCounter;
    }

    // Public method: global. access to bool global
    public bool getGlobalEnabled() {
        return global.globalEnabled;
    }

    // Public method: global. access to signed global
    public i16 getGlobalOffset() {
        return global.globalOffset;
    }

    // Public method: global. access to float global
    public f32 getGlobalScale() {
        return global.globalScale;
    }

    // ========================================
    // PUBLIC METHODS - combined this. and global.
    // ========================================

    // Public method: combine scope and global values (unsigned)
    public u8 computePublicSum() {
        return this.publicValue + global.globalCounter;
    }

    // Public method: compare scope and global values
    public bool publicValueBelowMax() {
        return this.publicValue < global.GLOBAL_MAX;
    }

    // Public method: offset calculation using this. and global.
    public i32 computePublicWithOffset() {
        return this.publicOffset + global.globalOffset;
    }

    // Public method: call private method (tests method chaining)
    public u8 getPrivateSumViaInternal() {
        return this.computePrivateSum();
    }

    // Public method: call private method that uses global.
    public u8 getGlobalCounterViaInternal() {
        return this.getGlobalCounterInternal();
    }

    // Public method: call private method that uses this.
    public u8 getPrivateClampViaInternal() {
        return this.getPrivateClampValue();
    }

    // ========================================
    // PUBLIC METHODS - comprehensive tests
    // ========================================

    // Public method: access all private modifiers via this.
    public void modifyAllPrivate() {
        this.privateValue <- this.privateValue + 1;
        this.privateClampValue +<- 10;
        this.privateWrapValue +<- 5;
        this.privateFlag <- !this.privateFlag;
        this.privateOffset <- this.privateOffset - 10;
    }

    // Public method: access all public modifiers via this.
    public void modifyAllPublic() {
        this.publicValue <- this.publicValue + 1;
        this.publicClampValue +<- 100;
        this.publicWrapValue +<- 5;
        this.publicFlag <- !this.publicFlag;
        this.publicOffset <- this.publicOffset - 100;
    }

    // Public method: mixed access - scope members and global values
    public bool checkThresholds() {
        return this.publicClampValue < global.GLOBAL_THRESHOLD && this.privateValue < global.GLOBAL_MAX;
    }

    // Public method: all bool flags
    public bool getAllFlags() {
        return this.privateFlag && this.publicFlag && global.globalEnabled;
    }
}

u32 main() {
    // ==========================================
    // SECTION 1: Public methods accessing private members via this.
    // ==========================================

    // Test 1: getPrivateValueExternal() returns initial private value (10)
    u8 res1 <- MethodContexts.getPrivateValueExternal();
    if (res1 != 10) return 1;

    // Test 2: getPrivateSumViaInternal() - private method called by public
    // privateValue(10) + globalCounter(50) = 60
    u8 res2 <- MethodContexts.getPrivateSumViaInternal();
    if (res2 != 60) return 2;

    // Test 3: getGlobalCounterViaInternal() - private method accessing global
    u8 res3 <- MethodContexts.getGlobalCounterViaInternal();
    if (res3 != 50) return 3;

    // Test 4: getPrivateClampViaInternal() - private method with clamp modifier
    u8 res4 <- MethodContexts.getPrivateClampViaInternal();
    if (res4 != 200) return 4;

    // ==========================================
    // SECTION 2: Public methods accessing public members via this.
    // ==========================================

    // Test 5: getPublicValue() returns initial public value (20)
    u8 res5 <- MethodContexts.getPublicValue();
    if (res5 != 20) return 5;

    // Test 6: getPublicClampValue() - public clamp variable (60000)
    u16 res6 <- MethodContexts.getPublicClampValue();
    if (res6 != 60000) return 6;

    // Test 7: getPublicWrapValue() - public wrap variable (65530)
    u16 res7 <- MethodContexts.getPublicWrapValue();
    if (res7 != 65530) return 7;

    // Test 8: getPublicFlag() - public boolean (true)
    bool res8 <- MethodContexts.getPublicFlag();
    if (res8 != true) return 8;

    // Test 9: getPublicOffset() - public signed integer (-1000)
    i32 res9 <- MethodContexts.getPublicOffset();
    if (res9 != -1000) return 9;

    // ==========================================
    // SECTION 3: Public methods accessing global. values
    // ==========================================

    // Test 10: getGlobalMax() - const global (100)
    u8 res10 <- MethodContexts.getGlobalMax();
    if (res10 != 100) return 10;

    // Test 11: getGlobalThreshold() - const global (1000)
    u16 res11 <- MethodContexts.getGlobalThreshold();
    if (res11 != 1000) return 11;

    // Test 12: getGlobalCounter() - mutable global (50)
    u8 res12 <- MethodContexts.getGlobalCounter();
    if (res12 != 50) return 12;

    // Test 13: getGlobalEnabled() - bool global (true)
    bool res13 <- MethodContexts.getGlobalEnabled();
    if (res13 != true) return 13;

    // Test 14: getGlobalOffset() - signed global (-25)
    i16 res14 <- MethodContexts.getGlobalOffset();
    if (res14 != -25) return 14;

    // Test 15: getGlobalScale() - float global (2.5)
    f32 expectedScale <- 2.5;
    f32 res15 <- MethodContexts.getGlobalScale();
    if (res15 != expectedScale) return 15;

    // ==========================================
    // SECTION 4: Combined this. and global. access
    // ==========================================

    // Test 16: computePublicSum() - publicValue(20) + globalCounter(50) = 70
    u8 res16 <- MethodContexts.computePublicSum();
    if (res16 != 70) return 16;

    // Test 17: publicValueBelowMax() - publicValue(20) < GLOBAL_MAX(100) = true
    bool res17 <- MethodContexts.publicValueBelowMax();
    if (res17 != true) return 17;

    // Test 18: computePublicWithOffset() - publicOffset(-1000) + globalOffset(-25) = -1025
    i32 res18 <- MethodContexts.computePublicWithOffset();
    if (res18 != -1025) return 18;

    // ==========================================
    // SECTION 5: Setter methods modify state
    // ==========================================

    // Test 19-20: setPrivateValue and verify
    MethodContexts.setPrivateValue(42);
    u8 res19 <- MethodContexts.getPrivateValueExternal();
    if (res19 != 42) return 19;

    // Test 20: Verify computePrivateSum - privateValue(42) + globalCounter(50) = 92
    u8 res20 <- MethodContexts.getPrivateSumViaInternal();
    if (res20 != 92) return 20;

    // Test 21-22: setPublicValue and verify
    MethodContexts.setPublicValue(84);
    u8 res21 <- MethodContexts.getPublicValue();
    if (res21 != 84) return 21;

    // Test 22: Verify computePublicSum - publicValue(84) + globalCounter(50) = 134
    u8 res22 <- MethodContexts.computePublicSum();
    if (res22 != 134) return 22;

    // Test 23: setPrivateFlag and verify
    MethodContexts.setPrivateFlag(true);

    // Test 24: setPublicFlag and verify
    MethodContexts.setPublicFlag(false);
    bool res24 <- MethodContexts.getPublicFlag();
    if (res24 != false) return 24;

    // ==========================================
    // SECTION 6: Modifier behavior (clamp/wrap)
    // ==========================================

    // Test 25: incrementPublicClamp - adds 10000 to 60000, clamps at 65535
    MethodContexts.incrementPublicClamp();
    u16 res25 <- MethodContexts.getPublicClampValue();
    if (res25 != 65535) return 25;

    // Test 26: incrementPublicWrap - adds 10 to 65530, wraps around
    MethodContexts.incrementPublicWrap();
    u16 res26 <- MethodContexts.getPublicWrapValue();
    if (res26 != 4) return 26;

    // ==========================================
    // SECTION 7: modifyAllPrivate comprehensive test
    // ==========================================

    // Test 27: Call modifyAllPrivate - modifies persisted values
    MethodContexts.modifyAllPrivate();
    u8 res27 <- MethodContexts.getPrivateValueExternal();
    if (res27 != 43) return 27;

    // Test 28: privateClampValue: 200 + 10 = 210
    u8 res28 <- MethodContexts.getPrivateClampViaInternal();
    if (res28 != 210) return 28;

    // ==========================================
    // SECTION 8: modifyAllPublic comprehensive test
    // ==========================================

    // Test 30: Call modifyAllPublic - modifies persisted values
    MethodContexts.modifyAllPublic();
    u8 res30 <- MethodContexts.getPublicValue();
    if (res30 != 85) return 30;

    // Test 31: publicClampValue: 65535 + 100 = clamped to 65535
    u16 res31 <- MethodContexts.getPublicClampValue();
    if (res31 != 65535) return 31;

    // Test 32: publicWrapValue: 4 + 5 = 9
    u16 res32 <- MethodContexts.getPublicWrapValue();
    if (res32 != 9) return 32;

    // Test 33: publicFlag: !false = true
    bool res33 <- MethodContexts.getPublicFlag();
    if (res33 != true) return 33;

    // Test 34: publicOffset: -1000 - 100 = -1100
    i32 res34 <- MethodContexts.getPublicOffset();
    if (res34 != -1100) return 34;

    // ==========================================
    // SECTION 9: Threshold and flag checks
    // ==========================================

    // Test 35: checkThresholds() - only reads
    bool res35 <- MethodContexts.checkThresholds();
    if (res35 != false) return 35;

    // Test 36: getAllFlags() - only reads
    bool res36 <- MethodContexts.getAllFlags();
    if (res36 != false) return 36;

    // ==========================================
    // SECTION 10: Direct public variable access
    // ==========================================

    // Test 37: Direct read of publicValue
    if (MethodContexts.publicValue != 85) return 37;

    // Test 38: Direct read of publicClampValue
    if (MethodContexts.publicClampValue != 65535) return 38;

    // Test 39: Direct read of publicWrapValue
    if (MethodContexts.publicWrapValue != 9) return 39;

    // Test 40: Direct read of publicFlag
    if (MethodContexts.publicFlag != true) return 40;

    // Test 41: Direct read of publicOffset
    if (MethodContexts.publicOffset != -1100) return 41;

    // ==========================================
    // SECTION 11: Direct public variable modification
    // ==========================================

    // Test 42: Direct write to publicValue and verify via getter
    MethodContexts.publicValue <- 99;
    u8 res42 <- MethodContexts.getPublicValue();
    if (res42 != 99) return 42;

    // Test 43: Direct write to publicFlag and verify via getter
    MethodContexts.publicFlag <- false;
    bool res43 <- MethodContexts.getPublicFlag();
    if (res43 != false) return 43;

    // All 43 validations passed
    return 0;
}
