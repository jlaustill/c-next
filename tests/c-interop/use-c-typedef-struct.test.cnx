// test-execution
// test-coverage: 30-use-c-typedef-struct
// Tests: Using C typedef'd struct types from header
// ADR-010: Struct typedef import from C headers

#include "c-interop/typedefs.h"

u32 main() {
   
// Test 1: Declare Point2D variable
    Point2D p;
    p.x <- 10;
    p.y <- 20;
    if (p.x != 10) return 1;
    if (p.y != 20) return 2;

   
// Test 2: Use Record typedef
    Record r;
    r.id <- 12345;
    r.flags <- 0xFF;
    r.status <- 1;
    if (r.id != 12345) return 3;
    if (r.flags != 0xFF) return 4;

   
// Test 3: Use SizedFields typedef (.length property)
    SizedFields sf;
    sf.byte_field <- 255;
    sf.word_field <- 65535;
    sf.dword_field <- 0xFFFFFFFF;
    sf.qword_field <- 0xFFFFFFFFFFFFFFFF;

    if (sf.byte_field != 255) return 5;
    if (sf.word_field != 65535) return 6;
    if (sf.dword_field != 0xFFFFFFFF) return 7;

   
// Test 4: Verify field sizes via .length
    if (sf.byte_field.length != 8) return 8;
    if (sf.word_field.length != 16) return 9;
    if (sf.dword_field.length != 32) return 10;
    if (sf.qword_field.length != 64) return 11;

    return 0;  // All tests passed
}
